DROP TRIGGER CWSINT.trg_coltrl_t_ins;

CREATE TRIGGER CWSINT.trg_coltrl_t_ins
AFTER INSERT ON CWSINT.COLTRL_T
REFERENCING NEW AS NROW
FOR EACH ROW MODE DB2SQL
BEGIN ATOMIC
	MERGE INTO CWSRS1.COLTRL_T tgt USING ( 
	SELECT
		nrow.IDENTIFIER,
		nrow.BADGE_NO,
		nrow.CITY_NM,
		nrow.EMPLYR_NM,
		nrow.FAX_NO,
		nrow.FIRST_NM,
		nrow.FRG_ADRT_B,
		nrow.LAST_NM,
		nrow.MID_INI_NM,
		nrow.NMPRFX_DSC,
		nrow.PRM_TEL_NO,
		nrow.PRM_EXT_NO,
		nrow.STATE_C,
		nrow.STREET_NM,
		nrow.STREET_NO,
		nrow.SUFX_TLDSC,
		nrow.ZIP_NO,
		nrow.LST_UPD_ID,
		nrow.LST_UPD_TS,
		nrow.ZIP_SFX_NO,
		nrow.COMNT_DSC,
		nrow.GENDER_CD,
		nrow.BIRTH_DT,
		nrow.MRTL_STC,
		nrow.EMAIL_ADDR,
		nrow.ESTBLSH_CD,
		nrow.ESTBLSH_ID,
		nrow.RESOST_IND
		FROM sysibm.sysdummy1
	) X ON (tgt.IDENTIFIER = X.IDENTIFIER)
	WHEN MATCHED THEN UPDATE SET 
		BADGE_NO = x.BADGE_NO,
		CITY_NM = x.CITY_NM,
		EMPLYR_NM = x.EMPLYR_NM,
		FAX_NO = x.FAX_NO,
		FIRST_NM = x.FIRST_NM,
		FRG_ADRT_B = x.FRG_ADRT_B,
		LAST_NM = x.LAST_NM,
		MID_INI_NM = x.MID_INI_NM,
		NMPRFX_DSC = x.NMPRFX_DSC,
		PRM_TEL_NO = x.PRM_TEL_NO,
		PRM_EXT_NO = x.PRM_EXT_NO,
		STATE_C = x.STATE_C,
		STREET_NM = x.STREET_NM,
		STREET_NO = x.STREET_NO,
		SUFX_TLDSC = x.SUFX_TLDSC,
		ZIP_NO = x.ZIP_NO,
		LST_UPD_ID = x.LST_UPD_ID,
		LST_UPD_TS = x.LST_UPD_TS,
		ZIP_SFX_NO = x.ZIP_SFX_NO,
		COMNT_DSC = x.COMNT_DSC,
		GENDER_CD = x.GENDER_CD,
		BIRTH_DT = x.BIRTH_DT,
		MRTL_STC = x.MRTL_STC,
		EMAIL_ADDR = x.EMAIL_ADDR,
		ESTBLSH_CD = x.ESTBLSH_CD,
		ESTBLSH_ID = x.ESTBLSH_ID,
		RESOST_IND = x.RESOST_IND,
		IBMSNAP_OPERATION = 'I',
		IBMSNAP_LOGMARKER = current timestamp
	WHEN NOT MATCHED THEN INSERT (
		IDENTIFIER,
		BADGE_NO,
		CITY_NM,
		EMPLYR_NM,
		FAX_NO,
		FIRST_NM,
		FRG_ADRT_B,
		LAST_NM,
		MID_INI_NM,
		NMPRFX_DSC,
		PRM_TEL_NO,
		PRM_EXT_NO,
		STATE_C,
		STREET_NM,
		STREET_NO,
		SUFX_TLDSC,
		ZIP_NO,
		LST_UPD_ID,
		LST_UPD_TS,
		ZIP_SFX_NO,
		COMNT_DSC,
		GENDER_CD,
		BIRTH_DT,
		MRTL_STC,
		EMAIL_ADDR,
		ESTBLSH_CD,
		ESTBLSH_ID,
		RESOST_IND,
		IBMSNAP_OPERATION,
		IBMSNAP_LOGMARKER
	) VALUES (
		x.IDENTIFIER,
		x.BADGE_NO,
		x.CITY_NM,
		x.EMPLYR_NM,
		x.FAX_NO,
		x.FIRST_NM,
		x.FRG_ADRT_B,
		x.LAST_NM,
		x.MID_INI_NM,
		x.NMPRFX_DSC,
		x.PRM_TEL_NO,
		x.PRM_EXT_NO,
		x.STATE_C,
		x.STREET_NM,
		x.STREET_NO,
		x.SUFX_TLDSC,
		x.ZIP_NO,
		x.LST_UPD_ID,
		x.LST_UPD_TS,
		x.ZIP_SFX_NO,
		x.COMNT_DSC,
		x.GENDER_CD,
		x.BIRTH_DT,
		x.MRTL_STC,
		x.EMAIL_ADDR,
		x.ESTBLSH_CD,
		x.ESTBLSH_ID,
		x.RESOST_IND,
		'I',
		current timestamp
	);
END
